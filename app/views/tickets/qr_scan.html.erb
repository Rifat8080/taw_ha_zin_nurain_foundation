<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="bg-white shadow-md rounded-lg overflow-hidden">
    <div class="px-6 py-5 border-b bg-gradient-to-r from-green-600 to-blue-600">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-2xl font-semibold text-white">QR Code Scanner</h1>
          <p class="text-green-100 mt-1 text-sm">Fast check-ins • Meals • Breaks • Re-entry</p>
        </div>
        <div class="text-right text-sm text-green-100">Ready to scan</div>
      </div>
    </div>

    <div class="p-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Camera / Scanner -->
      <div class="col-span-1 lg:col-span-2">
        <div id="qr-scanner" class="w-full h-full rounded-md bg-gray-50 p-4 flex flex-col" data-validate-url="<%= validate_qr_tickets_path %>" data-default-operation="entry">
          <div class="flex items-center justify-between mb-3">
            <div class="flex items-center gap-3">
              <svg class="h-6 w-6 text-white bg-green-600 rounded-full p-1" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 7v10a2 2 0 0 0 2 2h14" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
              <h2 class="text-lg font-medium text-gray-900">Live Camera</h2>
            </div>
            <div class="flex items-center gap-2">
              <label for="qr-operation-select" class="text-sm font-medium text-gray-700">Operation</label>
              <select id="qr-operation-select" class="rounded-md border-gray-300 shadow-sm text-sm">
                <option value="entry" selected>Entry</option>
                <option value="reentry">Re-entry</option>
                <option value="meal">Meal</option>
                <option value="start_break">Start Break</option>
                <option value="end_break">End Break</option>
                <option value="status_check">Status Check</option>
              </select>
            </div>
          </div>

          <div class="rounded border border-dashed border-gray-200 overflow-hidden bg-black">
            <video id="video" class="w-full h-80 object-cover" autoplay muted playsinline></video>
          </div>

          <div class="mt-4 flex items-center gap-3">
            <button id="start-scan" class="inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
              Start Scanning
            </button>
            <button id="stop-scan" class="inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 hidden">
              Stop Scanning
            </button>

            <div class="ml-auto text-sm text-gray-500">Tip: Aim the QR code at the center of the frame</div>
          </div>
        </div>
      </div>

      <!-- Manual Entry & Results -->
      <div class="col-span-1">
        <div class="space-y-4">
          <div class="p-4 bg-white border rounded-md shadow-sm">
            <h3 class="text-sm font-medium text-gray-900 mb-2">Manual QR Code Entry</h3>
            <div class="flex gap-2">
              <input type="text" id="manual-qr" placeholder="Paste or type QR code..." class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" />
              <button data-action="validate-qr" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">Validate</button>
            </div>
            <p class="mt-2 text-xs text-gray-500">You can also choose the operation above before validating.</p>
          </div>

          <div id="scan-results" class="p-4 bg-gray-50 border rounded-md hidden">
            <h3 class="text-sm font-medium text-gray-900 mb-3">Scan Results</h3>
            <div id="result-content" class="space-y-3"></div>
          </div>

          <div class="p-3 text-xs text-gray-500 bg-white border rounded-md">
            <strong>Notes:</strong>
            <ul class="list-disc pl-5 mt-2">
              <li>Each operation (Entry, Meal, Break) is recorded once per ticket.</li>
              <li>Use <em>Status Check</em> to view current ticket state without changing it.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
