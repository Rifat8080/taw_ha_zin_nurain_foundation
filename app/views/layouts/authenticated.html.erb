<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Taw Ha Zin Nurain Foundation - Dashboard" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">
    
    <!-- Performance-optimized font loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Preload critical font weights -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"></noscript>

    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "fonts", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    
    <!-- Flowbite CSS -->
   <!-- Flowbite CSS (non-blocking) -->
   <link rel="preload" href="https://cdn.jsdelivr.net/npm/flowbite@2.5.1/dist/flowbite.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
   <noscript><link href="https://cdn.jsdelivr.net/npm/flowbite@2.5.1/dist/flowbite.min.css" rel="stylesheet" /></noscript>
   <!-- Font Awesome -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
  </head>

  <body class="bg-white font-sans">
   <!-- Fixed top navigation -->
   <nav class="fixed top-0 z-50 w-full bg-white xl:bg-transparent border-b border-gray-200 lg:border-0 dark:bg-gray-800 dark:border-gray-700 lg:dark:border-0">
      <div class="px-3 py-3 lg:px-5 lg:pl-3">
        <div class="flex items-center justify-between">
          <div class="flex items-center justify-start rtl:justify-end">
            <button data-drawer-target="logo-sidebar" data-drawer-toggle="logo-sidebar" aria-controls="logo-sidebar" type="button" class="inline-flex items-center p-2 text-sm text-gray-500 rounded-lg xl:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600">
                <span class="sr-only">Open sidebar</span>
                <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                   <path clip-rule="evenodd" fill-rule="evenodd" d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z"></path>
                </svg>
             </button>
                  <%= link_to root_path, class: "flex items-center gap-3 ms-2 md:me-24" do %>
                     <%= image_tag 'Foundation_Logo_Side.png', class: 'h-14 w-auto rounded-md xl:hidden', alt: 'TawHaZin Foundation' %>
                  <% end %>
          </div>
          <div class="flex items-center">
              <div class="flex items-center ms-3">
                <div>
                  <button type="button" class="flex text-sm bg-gray-800 rounded-full focus:ring-4 focus:ring-gray-300 dark:focus:ring-gray-600" aria-expanded="false" data-dropdown-toggle="dropdown-user">
                    <span class="sr-only">Open user menu</span>
                    <div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center">
                      <span class="text-white font-medium text-sm"><%= current_user&.first_name&.first || 'U' %></span>
                    </div>
                  </button>
                </div>
                <div class="z-50 hidden my-4 text-base list-none bg-white divide-y divide-gray-100 rounded shadow dark:bg-gray-700 dark:divide-gray-600" id="dropdown-user">
                  <div class="px-4 py-3" role="none">
                    <p class="text-sm text-gray-900 dark:text-white" role="none">
                      <%= current_user&.full_name %>
                    </p>
                    <p class="text-sm font-medium text-gray-900 truncate dark:text-gray-300" role="none">
                      <%= current_user&.email %>
                    </p>
                  </div>
                  <ul class="py-1" role="none">
                    <li>
                      <%= link_to dashboard_path, class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-white", role: "menuitem" do %>Dashboard<% end %>
                    </li>
                    <li>
                      <%= link_to edit_user_registration_path, class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-white", role: "menuitem" do %>Settings<% end %>
                    </li>
                    <li>
                      <%= link_to root_path, class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-white", role: "menuitem" do %>View Public Site<% end %>
                    </li>
                    <li>
                      <%= button_to destroy_user_session_path, method: :delete, class: "w-full text-left block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-white", role: "menuitem" do %>Sign out<% end %>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
        </div>
      </div>
    </nav>

   <!-- Sidebar -->
   <aside id="logo-sidebar" class="fixed top-0 left-0 z-40 w-64 h-screen pt-20 transition-transform -translate-x-full bg-transparent border-r border-gray-200 lg:border-0 xl:hidden xl:translate-x-0 xl:[transform:translateX(0!important)] dark:bg-gray-800 dark:border-gray-700" aria-label="Sidebar">
         <div class="h-full px-3 pb-4 overflow-y-auto bg-forange text-white dark:bg-gray-800 rounded-lg lg:rounded-xl">
               <!-- Sidebar logo (visible on lg and up) -->
               <div class="hidden xl:block">
                  <%= link_to root_path do %>
                     <%= image_tag 'Foundation_Logo_Side.png', class: 'bg-white rounded-2xl h-12 w-auto mx-auto my-4 rounded-md', alt: 'TawHaZin Foundation' %>
                  <% end %>
               </div>
               <!-- Center the list on large screens -->
               <div class="w-full xl:flex xl:flex-col xl:items-center">
                  <ul class="space-y-2 pt-4 font-medium text-white w-full lg:w-auto">
             <li>
                <%= link_to dashboard_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-house shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="ms-3">Dashboard</span>
                <% end %>
             </li>
             
             <!-- Projects Section -->
             <li>
                <%= link_to projects_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-folder shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Projects</span>
                <% end %>
             </li>

             <!-- Healthcare Section -->
             <li>
                <%= link_to healthcare_requests_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-stethoscope shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Healthcare Requests</span>
                <% end %>
             </li>
             <li>
                <%= link_to healthcare_donations_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-credit-card shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Healthcare Donations</span>
                <% end %>
             </li>

             <!-- Volunteers Section -->
             <li>
                <%= link_to volunteers_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-hands-helping shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Volunteers</span>
                <% end %>
             </li>
             <li>
                <%= link_to volunteers_teams_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-users shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Volunteer Teams</span>
                <% end %>
             </li>
             <li>
                <%= link_to work_orders_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-tools shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Work Orders</span>
                <% end %>
             </li>

             <!-- Events Section -->
             <li>
                <%= link_to events_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-calendar-days shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Events</span>
                <% end %>
             </li>
             <li>
                <%= link_to tickets_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-ticket shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Tickets</span>
                <% end %>
             </li>
             <li>
                <%= link_to qr_scan_tickets_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-qrcode shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">QR Scanner</span>
                <% end %>
             </li>
             <% if current_user.is_volunteer? || current_user.role == 'admin' %>
               <li>
                  <%= link_to spot_registration_tickets_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                     <i class="fa-solid fa-tag shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                     <span class="flex-1 ms-3 whitespace-nowrap">Spot Registration</span>
                  <% end %>
               </li>
             <% end %>

             <!-- Financial Section -->
             <li>
                <%= link_to donations_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-hand-holding-dollar shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Donations</span>
                <% end %>
             </li>
             <li>
                <%= link_to expenses_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-chart-line shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Expenses</span>
                <% end %>
             </li>

             <!-- Zakat Calculator -->
             <li>
                <%= link_to zakat_calculations_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-calculator shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Zakat Calculator</span>
                <% end %>
             </li>

             <% if current_user&.role == 'admin' %>
             <!-- Nisab Rates (Admin Only) -->
             <li>
                <%= link_to nisab_rates_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                      <i class="fa-solid fa-balance-scale shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Nisab Rates</span>
                <% end %>
             </li>
             <!-- User Management (Admin Only) -->
             <li>
                <%= link_to users_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                      <i class="fa-solid fa-user shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">User Management</span>
                <% end %>
                   </li>
                   <% end %>
               </ul>
            </div>
         </div>
    </aside>

   <!-- Static sidebar for xl and up (no Flowbite) -->
   <aside id="logo-sidebar-xl" class="hidden xl:block fixed top-2 left-5 z-40 w-64 h-[90%] pt-15 rounded-lg bg-transparent dark:bg-gray-800 dark:border-gray-700" aria-label="Sidebar">
         <div class="h-full px-3 pb-4 overflow-y-auto bg-forange text-white dark:bg-gray-800 rounded-lg lg:rounded-xl">
               <!-- Sidebar logo (visible on xl and up) -->
               <div class="block">
                  <%= link_to root_path do %>
                     <%= image_tag 'Foundation_Logo_Side.png', class: 'bg-white rounded-2xl h-12 w-auto mx-auto my-4 rounded-md', alt: 'TawHaZin Foundation' %>
                  <% end %>
               </div>
               <!-- Center the list on large screens -->
               <div class="w-full xl:flex xl:flex-col xl:items-center">
                  <ul class="space-y-2 font-medium text-white w-full lg:w-auto">
             <li>
                <%= link_to dashboard_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-house shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="ms-3">Dashboard</span>
                <% end %>
             </li>
             
             <!-- Projects Section -->
             <li>
                <%= link_to projects_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-folder shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Projects</span>
                <% end %>
             </li>

             <!-- Healthcare Section -->
             <li>
                <%= link_to healthcare_requests_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-stethoscope shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Healthcare Requests</span>
                <% end %>
             </li>
             <li>
                <%= link_to healthcare_donations_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-credit-card shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Healthcare Donations</span>
                <% end %>
             </li>

             <!-- Volunteers Section -->
             <li>
                <%= link_to volunteers_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-hands-helping shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Volunteers</span>
                <% end %>
             </li>
             <li>
                <%= link_to volunteers_teams_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-users shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Volunteer Teams</span>
                <% end %>
             </li>
             <li>
                <%= link_to work_orders_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-tools shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Work Orders</span>
                <% end %>
             </li>

             <!-- Events Section -->
             <li>
                <%= link_to events_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-calendar-days shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Events</span>
                <% end %>
             </li>
             <li>
                <%= link_to tickets_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-ticket shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Tickets</span>
                <% end %>
             </li>
             <li>
                <%= link_to qr_scan_tickets_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-qrcode shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">QR Scanner</span>
                <% end %>
             </li>
             <% if current_user.is_volunteer? || current_user.role == 'admin' %>
               <li>
                  <%= link_to spot_registration_tickets_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                     <i class="fa-solid fa-tag shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                     <span class="flex-1 ms-3 whitespace-nowrap">Spot Registration</span>
                  <% end %>
               </li>
             <% end %>

             <!-- Financial Section -->
             <li>
                <%= link_to donations_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-hand-holding-dollar shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Donations</span>
                <% end %>
             </li>
             <li>
                <%= link_to expenses_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-chart-line shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Expenses</span>
                <% end %>
             </li>

             <!-- Zakat Calculator -->
             <li>
                <%= link_to zakat_calculations_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                   <i class="fa-solid fa-calculator shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Zakat Calculator</span>
                <% end %>
             </li>

             <% if current_user&.role == 'admin' %>
             <!-- Nisab Rates (Admin Only) -->
             <li>
                <%= link_to nisab_rates_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg_gray-100 dark:hover:bg-gray-700 group" do %>
                      <i class="fa-solid fa-balance-scale shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">Nisab Rates</span>
                <% end %>
             </li>
             <!-- User Management (Admin Only) -->
             <li>
                <%= link_to users_path, class: "flex items-center p-2 text-white rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group" do %>
                      <i class="fa-solid fa-user shrink-0 w-5 h-5 flex items-center justify-center text-white" aria-hidden="true"></i>
                   <span class="flex-1 ms-3 whitespace-nowrap">User Management</span>
                <% end %>
                   </li>
                   <% end %>
               </ul>
            </div>
         </div>
    </aside>

    <!-- Main content area -->
   <div class="xl:ml-64">
      <!-- Flash Messages -->
      <% if flash[:notice] %>
        <div class="p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-green-400 mt-14" role="alert">
          <span class="font-medium">Success!</span> <%= flash[:notice] %>
        </div>
      <% end %>

      <% if flash[:alert] %>
        <div class="p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400 mt-14" role="alert">
          <span class="font-medium">Error!</span> <%= flash[:alert] %>
        </div>
      <% end %>

      <!-- Page content -->
      <main class="mt-14 ">
        <%= yield %>
      </main>
    </div>

   <!-- Flowbite JavaScript (deferred) -->
   <script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.1/dist/flowbite.min.js" defer></script>
  </body>
</html>
